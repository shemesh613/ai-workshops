<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>×—×“×¨ 3 â€” ×”×¨ ×¡×™× ×™</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* â”€â”€ Interactive Mountain Scene â”€â”€ */
    .sinai-scene {
      position: relative; width: 100%; height: 320px; margin: 15px 0;
      border-radius: 12px; overflow: hidden; cursor: crosshair;
      border: 1px solid rgba(180,150,255,0.2);
      background: linear-gradient(to bottom,
        #050015 0%, #0a0030 20%, #150050 40%, #2a1060 55%, #3a2040 75%, #1a1020 100%);
    }
    /* Mountain shape */
    .sinai-mountain {
      position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
      width: 0; height: 0;
      border-left: 220px solid transparent; border-right: 220px solid transparent;
      border-bottom: 280px solid #1a1535;
    }
    .sinai-mountain-overlay {
      position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
      width: 0; height: 0;
      border-left: 180px solid transparent; border-right: 180px solid transparent;
      border-bottom: 240px solid #0f0a25;
    }
    /* Smoke at peak */
    .sinai-smoke {
      position: absolute; top: 15px; left: 50%; transform: translateX(-50%);
      width: 120px; height: 50px;
      background: radial-gradient(ellipse, rgba(200,180,255,0.25), transparent);
      border-radius: 50%; animation: smokeFloat 4s ease-in-out infinite alternate;
    }
    @keyframes smokeFloat {
      0% { opacity: 0.3; transform: translateX(-50%) scale(1) translateY(0); }
      100% { opacity: 0.5; transform: translateX(-50%) scale(1.2) translateY(-8px); }
    }
    /* Fire glow at base */
    .sinai-fire-glow {
      position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
      width: 300px; height: 80px;
      background: radial-gradient(ellipse at bottom, rgba(255,100,0,0.15), transparent);
      animation: fireGlow 2s ease-in-out infinite alternate;
    }
    @keyframes fireGlow {
      0% { opacity: 0.5; } 100% { opacity: 0.8; }
    }
    /* Stars */
    .sinai-star {
      position: absolute; width: 2px; height: 2px; background: #fff;
      border-radius: 50%; animation: starTwinkle 3s ease-in-out infinite alternate;
    }
    @keyframes starTwinkle { 0% { opacity: 0.2; } 100% { opacity: 0.8; } }

    /* Hidden hotspots */
    .hotspot {
      position: absolute; border-radius: 50%; cursor: pointer;
      transition: all 0.3s; z-index: 5;
    }
    .hotspot:hover { background: rgba(255,215,0,0.1); box-shadow: 0 0 20px rgba(255,215,0,0.15); }
    .hotspot.found {
      background: rgba(255,215,0,0.15) !important;
      box-shadow: 0 0 25px rgba(255,215,0,0.3) !important;
      pointer-events: none; cursor: default;
    }
    .hotspot.found::after {
      content: 'âœ¨'; position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%); font-size: 1.2rem;
    }
    .hotspot.wrong-spot {
      animation: hotspotShake 0.4s ease-out;
      background: rgba(255,0,0,0.15);
    }
    @keyframes hotspotShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); } 75% { transform: translateX(5px); }
    }

    /* Found clues panel */
    .clues-panel {
      display: flex; flex-wrap: wrap; gap: 6px; margin: 10px 0; justify-content: center;
    }
    .clue-badge {
      padding: 6px 12px; border-radius: 8px; font-size: 0.75rem;
      background: rgba(255,215,0,0.05); border: 1px solid rgba(255,215,0,0.15);
      color: rgba(255,255,255,0.3); transition: all 0.5s;
      font-family: 'Frank Ruhl Libre', serif;
    }
    .clue-badge.revealed {
      background: rgba(255,215,0,0.12); border-color: rgba(255,215,0,0.4);
      color: rgba(255,215,0,0.9); animation: badgeReveal 0.5s ease-out;
    }
    @keyframes badgeReveal {
      from { transform: scale(0.5); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    /* Cipher section */
    .cipher-section {
      margin: 15px 0; padding: 18px; text-align: center;
      background: rgba(40,20,60,0.3); border: 1px solid rgba(180,150,255,0.2);
      border-radius: 12px; display: none;
    }
    .cipher-section.unlocked { display: block; animation: scrollReveal 0.8s ease-out; }

    .cipher-grid {
      display: flex; gap: 8px; justify-content: center; margin: 12px 0;
    }
    .cipher-cell {
      width: 55px; height: 70px; border: 2px solid rgba(180,150,255,0.3);
      border-radius: 10px; background: rgba(60,30,100,0.2);
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      cursor: pointer; transition: all 0.3s;
    }
    .cipher-cell:hover { border-color: rgba(180,150,255,0.6); background: rgba(80,40,120,0.3); }
    .cipher-cell .encoded {
      font-size: 1.4rem; color: rgba(255,100,100,0.8);
      font-family: 'Frank Ruhl Libre', serif;
    }
    .cipher-cell .decoded {
      font-size: 1.2rem; color: rgba(255,255,255,0.3); margin-top: 4px;
      font-family: 'Frank Ruhl Libre', serif; transition: all 0.3s;
    }
    .cipher-cell.solved { border-color: rgba(0,255,100,0.5); background: rgba(0,80,0,0.2); }
    .cipher-cell.solved .decoded { color: #00ff88; font-weight: bold; }

    /* Atbash reference */
    .atbash-table-container { margin: 10px 0; overflow-x: auto; }
    .atbash-table {
      margin: 0 auto; border-collapse: collapse; font-size: 0.7rem;
      font-family: 'Frank Ruhl Libre', serif;
    }
    .atbash-table td {
      padding: 3px 6px; border: 1px solid rgba(180,150,255,0.15);
      text-align: center; color: rgba(255,255,255,0.5);
    }
    .atbash-table .label-cell {
      color: rgba(180,150,255,0.5); font-weight: bold; background: rgba(40,20,60,0.3);
    }

    /* Matrix canvas */
    .sinai-vision {
      margin: 15px 0; border-radius: 12px; overflow: hidden;
      border: 1px solid rgba(180,150,255,0.2); background: rgba(0,0,0,0.3);
    }
    .sinai-vision canvas { width: 100%; display: block; }
    .sinai-label {
      text-align: center; padding: 8px; font-size: 0.8rem;
      color: rgba(180,150,255,0.5); background: rgba(20,10,40,0.5);
    }

    .screen-shake { animation: screenShake 0.6s ease-out; }
    @keyframes screenShake {
      0%, 100% { transform: translateX(0); }
      10% { transform: translateX(-8px); } 20% { transform: translateX(8px); }
      30% { transform: translateX(-6px); } 40% { transform: translateX(6px); }
      50% { transform: translateX(-4px); } 60% { transform: translateX(4px); }
    }
    @keyframes scrollReveal {
      from { opacity:0; transform: scaleY(0.3); }
      to { opacity:1; transform: scaleY(1); }
    }

    @media (max-width: 600px) {
      .sinai-scene { height: 250px; }
      .sinai-mountain { border-left-width: 160px; border-right-width: 160px; border-bottom-width: 220px; }
      .sinai-mountain-overlay { border-left-width: 130px; border-right-width: 130px; border-bottom-width: 190px; }
      .cipher-cell { width: 45px; height: 60px; }
      .cipher-cell .encoded { font-size: 1.1rem; }
      .cipher-cell .decoded { font-size: 1rem; }
    }
  </style>
</head>
<body class="theme-sinai">

  <!-- Video Background -->
  <video class="video-bg" autoplay muted loop playsinline
    poster="https://images.unsplash.com/photo-1534088568595-a066f410bcda?w=1920&q=80">
    <source src="https://cdn.coverr.co/videos/coverr-lightning-storm-over-the-ocean-1902/1080p.mp4" type="video/mp4" />
  </video>
  <div class="fog-overlay"></div>
  <div class="dark-overlay"></div>

  <!-- Flash Overlay for Lightning -->
  <div class="flash-overlay" id="flash-overlay"></div>

  <!-- Particle Canvas -->
  <canvas id="particles-canvas"></canvas>

  <!-- Timer Bar -->
  <div class="timer-bar">
    <span class="room-indicator">â›°ï¸ ×—×“×¨ 3 â€” ×”×¨ ×¡×™× ×™</span>
    <span class="timer-display" id="timer-display">00:00</span>
  </div>

  <!-- Main Container -->
  <div class="room-container">

    <div class="room-icon">â›°ï¸</div>
    <h1 class="room-title glitch" data-text="×”×¨ ×¡×™× ×™">×”×¨ ×¡×™× ×™</h1>
    <p class="room-subtitle">×‘×¨×§×™× ×•×¨×¢××™×. ×¡×•×“×•×ª ×—×‘×•×™×™× ×‘×”×¨. ××¦× ××•×ª×.</p>

    <div class="question-box">
      <p class="question-text">×›××” ×™××™× ×©×”×” ××©×” ×¢×œ ×”×¨ ×¡×™× ×™?</p>
      <p style="font-size: 0.85rem; color: rgba(180,150,255,0.5); margin-top: 8px;">
        ğŸ‘ï¸ ×—×¤×© 5 ××’×™×œ×•×ª ×—×‘×•×™×•×ª ×‘×”×¨. ×›×œ ××’×™×œ×” ×—×•×©×¤×ª ×¨××–. ×”×¡×•×“ ××•×¦×¤×Ÿ ×‘××ª×‘"×©.
      </p>
    </div>

    <!-- Interactive Mountain Scene â€” find hidden scrolls -->
    <p style="font-size:0.85rem; color:rgba(180,150,255,0.4); text-align:center; margin:8px 0;">
      ğŸ” ×œ×—×¥ ×¢×œ ××§×•××•×ª ×—×©×•×“×™× ×‘×”×¨ ×›×“×™ ×œ×’×œ×•×ª ××’×™×œ×•×ª ×—×‘×•×™×•×ª:
    </p>

    <div class="sinai-scene" id="sinai-scene" onclick="clickScene(event)">
      <!-- Stars -->
      <div class="sinai-star" style="top:12%; left:15%; animation-delay:0s;"></div>
      <div class="sinai-star" style="top:8%; left:75%; animation-delay:1s;"></div>
      <div class="sinai-star" style="top:18%; left:35%; animation-delay:0.5s;"></div>
      <div class="sinai-star" style="top:5%; left:55%; animation-delay:1.5s;"></div>
      <div class="sinai-star" style="top:15%; left:90%; animation-delay:2s;"></div>
      <div class="sinai-star" style="top:22%; left:10%; animation-delay:0.7s;"></div>
      <div class="sinai-star" style="top:10%; left:45%; animation-delay:1.2s;"></div>
      <div class="sinai-star" style="top:3%; left:25%; animation-delay:0.3s;"></div>

      <!-- Smoke at peak -->
      <div class="sinai-smoke"></div>

      <!-- Mountain -->
      <div class="sinai-mountain"></div>
      <div class="sinai-mountain-overlay"></div>

      <!-- Fire glow -->
      <div class="sinai-fire-glow"></div>

      <!-- 5 Hidden hotspots -->
      <!-- 1. Cloud/smoke at peak -->
      <div class="hotspot" id="hs-0" data-index="0" onclick="event.stopPropagation(); findHotspot(0)"
        style="top: 10%; left: 43%; width: 55px; height: 40px;" title=""></div>

      <!-- 2. Lightning area (right) -->
      <div class="hotspot" id="hs-1" data-index="1" onclick="event.stopPropagation(); findHotspot(1)"
        style="top: 28%; left: 65%; width: 45px; height: 45px;" title=""></div>

      <!-- 3. Tablets on the mountain -->
      <div class="hotspot" id="hs-2" data-index="2" onclick="event.stopPropagation(); findHotspot(2)"
        style="top: 42%; left: 46%; width: 50px; height: 40px;" title=""></div>

      <!-- 4. Fire at base -->
      <div class="hotspot" id="hs-3" data-index="3" onclick="event.stopPropagation(); findHotspot(3)"
        style="top: 72%; left: 40%; width: 55px; height: 40px;" title=""></div>

      <!-- 5. People gathered at foot -->
      <div class="hotspot" id="hs-4" data-index="4" onclick="event.stopPropagation(); findHotspot(4)"
        style="top: 82%; left: 20%; width: 60px; height: 35px;" title=""></div>
    </div>

    <!-- Found clues -->
    <div class="clues-panel">
      <div class="clue-badge" id="clue-0">â˜ï¸ ???</div>
      <div class="clue-badge" id="clue-1">âš¡ ???</div>
      <div class="clue-badge" id="clue-2">ğŸ“œ ???</div>
      <div class="clue-badge" id="clue-3">ğŸ”¥ ???</div>
      <div class="clue-badge" id="clue-4">ğŸ‘¥ ???</div>
    </div>

    <div style="text-align:center; font-family:'Secular One',sans-serif; font-size:0.85rem; color:rgba(180,150,255,0.4); margin:5px 0;">
      ××¦××ª <span id="found-count" style="color:rgba(180,150,255,0.7);">0</span> ××ª×•×š 5 ××’×™×œ×•×ª
    </div>

    <!-- Cipher section â€” unlocks after all 5 clues found -->
    <div class="cipher-section" id="cipher-section">
      <p style="color: #b496ff; font-size: 1rem; margin-bottom: 8px;">ğŸ” ×”××’×™×œ×•×ª ×—×©×¤×• ×¦×•×¤×Ÿ!</p>
      <p style="font-size: 0.85rem; color: rgba(255,255,255,0.5); margin-bottom: 12px;">
        ×”×¦×•×¤×Ÿ ××•×¦×¤×Ÿ ×‘××ª×‘"×©. ×œ×—×¥ ×¢×œ ×›×œ ××•×ª ×›×“×™ ×œ×¤×¢× ×—:
      </p>

      <div class="cipher-grid" id="cipher-grid"></div>

      <div class="atbash-table-container">
        <p style="font-size: 0.7rem; color: rgba(180,150,255,0.3); margin: 8px 0 4px; text-align: center;">
          ×˜×‘×œ×ª ××ª×‘"×© â€” ×”×©×ª××© ×‘×” ×œ×¤×¢× ×•×—:
        </p>
        <table class="atbash-table" id="atbash-ref"></table>
      </div>

      <p style="font-size: 0.8rem; color: rgba(255,215,0,0.5); margin-top: 10px;">
        ×©××•×ª ×›"×“:×™"×— â€” "×•×™×”×™ ××©×” ×‘×”×¨ <strong style="color:#ffd700;">???</strong> ×™×•× ×•??? ×œ×™×œ×”"
      </p>
    </div>

    <!-- Sinai matrix canvas -->
    <div class="sinai-vision">
      <canvas id="sinai-canvas"></canvas>
      <div class="sinai-label">â›°ï¸ ××•×ª×™×•×ª ×”×œ×•×—×•×ª × ×•×¤×œ×•×ª ××Ÿ ×”×©××™×...</div>
    </div>

    <!-- Sefaria -->
    <a href="https://www.sefaria.org/Exodus.24.18?lang=he" target="_blank" class="sefaria-link" style="margin:5px auto; display:inline-flex;">
      ğŸ“– ×©××•×ª ×›"×“:×™"×— â€” ×¡×¤×¨×™×
    </a>

    <div class="password-section">
      <div class="password-wrapper">
        <input type="text" class="password-input" placeholder="×›××” ×™××™×?..." inputmode="numeric" autocomplete="off">
        <button class="submit-btn">ğŸ”“ ×¤×ª×—</button>
      </div>
      <div class="attempts-display"></div>
      <div class="hint-box">ğŸ’¡ ×—×¤×© 5 ××’×™×œ×•×ª ×—×‘×•×™×•×ª ×‘×”×¨ ×¡×™× ×™. ×¤×¢× ×— ××ª ×”×¦×•×¤×Ÿ ×‘××ª×‘"×©.</div>
      <div class="hint-box strong">ğŸ”¥ ××¨×‘×¢×™× ×™×•×. ×›××” ×–×” ×‘×¡×¤×¨×•×ª?</div>
    </div>
  </div>

  <div class="red-flash"></div>
  <div class="success-overlay">
    <div class="success-message">â›°ï¸ ×”×œ×•×—×•×ª ×‘×™×“×™×š!</div>
    <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px; font-size: 1.1rem;">×¢×›×©×™×• â€” ×‘× ×” ××ª ×‘×™×ª ×”'. ×”××©×›×Ÿ ××—×›×”.</p>
    <a href="room4.html" class="next-room-btn">â†’ ××œ ×”××©×›×Ÿ ğŸº</a>
  </div>

  <!-- Scripts -->
  <script src="particles.js"></script>
  <script src="game.js"></script>
  <script>
    if (!checkRoomAccess(3)) throw 'Access denied';
    new ParticleEngine('particles-canvas', 'dust');
    const timer = new GameTimer();
    const checker = new PasswordChecker('room3', 'room4.html');
    startLightning(6000, 15000);

    // â”€â”€ Hotspot Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const hotspots = [
      { icon: 'â˜ï¸', label: '×¢× ×Ÿ ×”×›×‘×•×“', verse: '"×•Ö·×™Ö´Ö¼×©Ö°××›Ö¹Ö¼×Ÿ ×›Ö°Ö¼×‘×•Ö¹×“ ×”\' ×¢Ö·×œ ×”Ö·×¨ ×¡Ö´×™× Ö·×™"' },
      { icon: 'âš¡', label: '×‘×¨×§×™× ×•×¨×¢××™×', verse: '"×•Ö·×™Ö°×”Ö´×™ ×§Ö¹×œÖ¹×ª ×•Ö¼×‘Ö°×¨Ö¸×§Ö´×™×"' },
      { icon: 'ğŸ“œ', label: '×œ×•×—×•×ª ×”×‘×¨×™×ª', verse: '"×•Ö·×™Ö´Ö¼×ªÖµÖ¼×Ÿ ×Ö¶×œ ×Ö¹×©Ö¶××”... ×œÖ»×—Ö¹×ª ×Ö¸×‘Ö¶×Ÿ"' },
      { icon: 'ğŸ”¥', label: '××© ×¢×œ ×”×”×¨', verse: '"×•Ö°×›Ö¸×œ ×”Ö¸×”Ö¸×¨ ×¢Ö¸×©Öµ××Ÿ"' },
      { icon: 'ğŸ‘¥', label: '×”×¢× ×œ××¨×’×œ×•×ª', verse: '"×•Ö·×™Ö·Ö¼×¢Ö²×Ö¹×“ ×”Ö¸×¢Ö¸× ×Öµ×¨Ö¸×—Ö¹×§"' }
    ];
    let foundHotspots = 0;
    const foundSet = new Set();

    function findHotspot(index) {
      if (foundSet.has(index)) return;
      foundSet.add(index);
      foundHotspots++;

      // Mark hotspot as found
      document.getElementById('hs-' + index).classList.add('found');

      // Reveal clue badge
      const badge = document.getElementById('clue-' + index);
      const hs = hotspots[index];
      badge.textContent = hs.icon + ' ' + hs.label;
      badge.classList.add('revealed');
      badge.title = hs.verse;

      // Update counter
      document.getElementById('found-count').textContent = foundHotspots;

      // Lightning flash effect
      const flash = document.getElementById('flash-overlay');
      flash.style.opacity = '0.3';
      setTimeout(() => flash.style.opacity = '0', 200);

      // All 5 found â†’ unlock cipher
      if (foundHotspots === 5) {
        setTimeout(() => {
          document.getElementById('cipher-section').classList.add('unlocked');
        }, 600);
      }
    }

    // Click on empty scene area â†’ wrong spot feedback
    function clickScene(event) {
      const scene = document.getElementById('sinai-scene');
      // Brief red flash on wrong click
      scene.style.boxShadow = '0 0 30px rgba(255,0,0,0.3) inset';
      scene.classList.add('screen-shake');
      setTimeout(() => {
        scene.style.boxShadow = '';
        scene.classList.remove('screen-shake');
      }, 400);
    }

    // â”€â”€ Atbash Cipher â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const answer = '××¨×‘×¢×™×';
    const aleph = '××‘×’×“×”×•×–×—×˜×™×›×œ×× ×¡×¢×¤×¦×§×¨×©×ª';
    const tav   = '×ª×©×¨×§×¦×¤×¢×¡× ××œ×›×™×˜×—×–×•×”×“×’×‘×';

    function atbashEncode(word) {
      return word.split('').map(c => {
        const i = aleph.indexOf(c);
        return i >= 0 ? tav[i] : c;
      }).join('');
    }

    const encoded = atbashEncode(answer);
    const cipherGrid = document.getElementById('cipher-grid');
    let solvedCount = 0;

    encoded.split('').forEach((char, i) => {
      const cell = document.createElement('div');
      cell.className = 'cipher-cell';
      cell.innerHTML = `<span class="encoded">${char}</span><span class="decoded" id="dec-${i}">?</span>`;
      cell.addEventListener('click', () => {
        const dec = document.getElementById('dec-' + i);
        if (dec.textContent === '?') {
          dec.textContent = answer[i];
          cell.classList.add('solved');
          solvedCount++;
          if (solvedCount === answer.length) {
            // All decoded â€” highlight password input
            setTimeout(() => document.querySelector('.password-input').focus(), 500);
          }
        } else {
          dec.textContent = '?';
          cell.classList.remove('solved');
          solvedCount--;
        }
      });
      cipherGrid.appendChild(cell);
    });

    // Atbash reference table
    const table = document.getElementById('atbash-ref');
    const row1 = document.createElement('tr');
    const row2 = document.createElement('tr');
    const l1 = document.createElement('td'); l1.className = 'label-cell'; l1.textContent = '×¨×’×™×œ'; row1.appendChild(l1);
    const l2 = document.createElement('td'); l2.className = 'label-cell'; l2.textContent = '××•×¦×¤×Ÿ'; row2.appendChild(l2);
    aleph.split('').forEach((c, i) => {
      const t1 = document.createElement('td'); t1.textContent = c; row1.appendChild(t1);
      const t2 = document.createElement('td'); t2.textContent = tav[i]; row2.appendChild(t2);
    });
    table.appendChild(row1);
    table.appendChild(row2);

    // â”€â”€ Matrix Canvas â€” Falling Hebrew Letters â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const sinaiCanvas = document.getElementById('sinai-canvas');
    const sinaiCtx = sinaiCanvas.getContext('2d');
    const cmdWords = ['×œ×','×ª×¨×¦×—','×œ×','×ª× ××£','×œ×','×ª×’× ×‘','×›×‘×“','××ª','××‘×™×š','×•××ª','×××š','×–×›×•×¨','××ª','×™×•×','×”×©×‘×ª','×œ×','×ª×©×','×©×','××œ×•×”×™×š','×œ×©×•×','×œ×','×ª×—××•×“','×× ×›×™','×”'];
    const answerWord = '××¨×‘×¢×™×';

    function initSinai() {
      sinaiCanvas.width = sinaiCanvas.parentElement.clientWidth;
      sinaiCanvas.height = 200;

      const columns = Math.floor(sinaiCanvas.width / 25);
      const drops = Array(columns).fill(0).map(() => Math.random() * 20);
      let frame = 0;

      function draw() {
        sinaiCtx.fillStyle = 'rgba(0,0,0,0.08)';
        sinaiCtx.fillRect(0, 0, sinaiCanvas.width, sinaiCanvas.height);
        frame++;

        for (let i = 0; i < drops.length; i++) {
          let word = cmdWords[Math.floor(Math.random() * cmdWords.length)];
          let color = 'rgba(180,150,255,0.6)';
          let size = 14;

          // Every ~200 frames, flash "××¨×‘×¢×™×" in gold
          if (frame % 200 > 170 && frame % 200 < 190) {
            const answerStart = Math.floor(columns / 2) - 2;
            if (i === answerStart) {
              word = answerWord;
              color = '#ffd700';
              size = 20;
              sinaiCtx.shadowBlur = 20;
              sinaiCtx.shadowColor = '#ffd700';
            }
          }

          sinaiCtx.fillStyle = color;
          sinaiCtx.font = size + 'px monospace';
          sinaiCtx.fillText(word.charAt(Math.floor(Math.random() * word.length)), i * 25, drops[i] * 25);
          sinaiCtx.shadowBlur = 0;

          if (drops[i] * 25 > sinaiCanvas.height && Math.random() > 0.975) drops[i] = 0;
          drops[i]++;
        }

        requestAnimationFrame(draw);
      }
      draw();
    }
    initSinai();
    window.addEventListener('resize', initSinai);
  </script>

</body>
</html>
