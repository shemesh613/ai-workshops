<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>×—×“×¨ 3 â€” ×”×¨ ×¡×™× ×™</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .sinai-vision {
      margin: 15px 0; border-radius: 12px; overflow: hidden;
      border: 1px solid rgba(180,150,255,0.2); background: rgba(0,0,0,0.3);
    }
    .sinai-vision canvas { width: 100%; display: block; }
    .sinai-label {
      text-align: center; padding: 8px; font-size: 0.8rem;
      color: rgba(180,150,255,0.5); background: rgba(20,10,40,0.5);
    }
    .commandments-grid {
      display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin: 15px 0;
    }
    .commandment-card {
      background: rgba(60,40,80,0.2); border: 2px solid rgba(180,150,255,0.2);
      border-radius: 10px; padding: 14px 10px; cursor: pointer;
      text-align: center; transition: all 0.3s;
    }
    .commandment-card:hover:not(.revealed) {
      background: rgba(80,60,120,0.3); border-color: rgba(180,150,255,0.4);
      transform: translateY(-2px);
    }
    .commandment-card .cmd-number {
      font-family: 'Amatic SC', cursive; font-size: 1.8rem;
      color: rgba(180,150,255,0.6);
    }
    .commandment-card .cmd-text {
      display: none; font-size: 0.8rem; color: rgba(255,255,255,0.7);
      margin-top: 5px;
    }
    .commandment-card.revealed {
      border-color: rgba(180,150,255,0.5); background: rgba(40,20,60,0.3);
      pointer-events: none;
    }
    .commandment-card.revealed .cmd-text { display: block; }
    .commandment-card.revealed .cmd-number { color: rgba(180,150,255,0.9); }

    .tablets-verse {
      display: none; margin: 15px 0; padding: 18px;
      background: rgba(40,20,60,0.3); border: 1px solid rgba(180,150,255,0.3);
      border-radius: 12px; text-align: center;
    }
    .tablets-verse.visible { display: block; animation: scrollReveal 0.8s ease-out; }
    @keyframes scrollReveal {
      from { opacity:0; transform: scaleY(0.3); }
      to { opacity:1; transform: scaleY(1); }
    }
    .cmd-counter {
      text-align: center; font-family: 'Secular One', sans-serif;
      font-size: 0.9rem; color: rgba(180,150,255,0.5); margin: 10px 0;
    }
    @media (max-width: 600px) {
      .commandment-card { padding: 10px 6px; }
      .commandment-card .cmd-number { font-size: 1.4rem; }
      .commandment-card .cmd-text { font-size: 0.7rem; }
    }
  </style>
</head>
<body class="theme-sinai">

  <!-- Video Background -->
  <video
    class="video-bg"
    autoplay
    muted
    loop
    playsinline
    poster="https://images.unsplash.com/photo-1534088568595-a066f410bcda?w=1920&q=80"
  >
    <source src="https://cdn.coverr.co/videos/coverr-lightning-storm-over-the-ocean-1902/1080p.mp4" type="video/mp4" />
  </video>
  <div class="dark-overlay"></div>

  <!-- Flash Overlay for Lightning Effect -->
  <div class="flash-overlay" id="flash-overlay"></div>

  <!-- Particle Canvas -->
  <canvas id="particles-canvas"></canvas>

  <!-- Timer Bar -->
  <div class="timer-bar">
    <span class="room-indicator">â›°ï¸ ×—×“×¨ 3 â€” ×”×¨ ×¡×™× ×™</span>
    <span class="timer-display" id="timer-display">00:00</span>
  </div>

  <!-- Main Container -->
  <div class="room-container">

    <!-- Title Section -->
    <div class="room-header">
      <h1 class="room-title">×”×¨ ×¡×™× ×™</h1>
      <p class="room-subtitle">×‘×¨×§×™× ×•×¨×¢××™×. ×”×œ×•×—×•×ª ×™×•×¨×“×™× ××Ÿ ×”×©××™×.</p>
    </div>

    <!-- Question -->
    <div class="question-box">
      <p class="question-text">
        ×›××” ×™××™× ×©×”×” ××©×” ×¢×œ ×”×¨ ×¡×™× ×™?
      </p>
    </div>

    <!-- Helper -->
    <p class="helper-text">
      ğŸ“œ ×¢×©×¨ ×“×™×‘×¨×•×ª ×—×§×•×§×•×ª ×‘××‘×Ÿ. ×’×œ×” ××ª ×›×•×œ×Ÿ â€” ×•×”××¡×¤×¨ ×™×™×—×©×£.
    </p>

    <!-- Sinai Canvas Vision -->
    <div class="sinai-vision">
      <canvas id="sinai-canvas"></canvas>
      <div class="sinai-label">â›°ï¸ ×œ×•×—×•×ª ×”×‘×¨×™×ª ×™×•×¨×“×™× ××Ÿ ×”×”×¨...</div>
    </div>

    <!-- 10 Commandments Grid -->
    <div class="commandments-container">
      <p style="font-size: 0.85rem; color: rgba(180,150,255,0.5); text-align: center; margin-bottom: 10px;">
        â›°ï¸ ×œ×—×¥ ×¢×œ ×›×œ ×“×™×‘×¨×” ×›×“×™ ×œ×—×©×•×£ ××•×ª×”:
      </p>
      <div class="commandments-grid">

        <div class="commandment-card" onclick="revealCmd(this, 0)">
          <div class="cmd-number">×</div>
          <div class="cmd-text">×× ×›×™ ×”' ××œ×•×”×™×š</div>
        </div>

        <div class="commandment-card" onclick="revealCmd(this, 1)">
          <div class="cmd-number">×‘</div>
          <div class="cmd-text">×œ× ×™×”×™×” ×œ×š ××œ×•×”×™× ××—×¨×™×</div>
        </div>

        <div class="commandment-card" onclick="revealCmd(this, 2)">
          <div class="cmd-number">×’</div>
          <div class="cmd-text">×œ× ×ª×™×©× ××ª ×©× ×”' ×œ×©×•×</div>
        </div>

        <div class="commandment-card" onclick="revealCmd(this, 3)">
          <div class="cmd-number">×“</div>
          <div class="cmd-text">×–×›×•×¨ ××ª ×™×•× ×”×©×‘×ª</div>
        </div>

        <div class="commandment-card" onclick="revealCmd(this, 4)">
          <div class="cmd-number">×”</div>
          <div class="cmd-text">×›×‘×“ ××ª ××‘×™×š ×•××ª ×××š</div>
        </div>

        <div class="commandment-card" onclick="revealCmd(this, 5)">
          <div class="cmd-number">×•</div>
          <div class="cmd-text">×œ× ×ª×¨×¦×—</div>
        </div>

        <div class="commandment-card" onclick="revealCmd(this, 6)">
          <div class="cmd-number">×–</div>
          <div class="cmd-text">×œ× ×ª× ××£</div>
        </div>

        <div class="commandment-card" onclick="revealCmd(this, 7)">
          <div class="cmd-number">×—</div>
          <div class="cmd-text">×œ× ×ª×’× ×‘</div>
        </div>

        <div class="commandment-card" onclick="revealCmd(this, 8)">
          <div class="cmd-number">×˜</div>
          <div class="cmd-text">×œ× ×ª×¢× ×” ×‘×¨×¢×š ×¢×“ ×©×§×¨</div>
        </div>

        <div class="commandment-card" onclick="revealCmd(this, 9)">
          <div class="cmd-number">×™</div>
          <div class="cmd-text">×œ× ×ª×—××•×“</div>
        </div>

      </div>
    </div>
    <!-- /commandments-container -->

    <!-- Counter -->
    <div class="cmd-counter">
      ×—×©×¤×ª <span id="cmd-count">0</span> ××ª×•×š 10 ×“×™×‘×¨×•×ª
    </div>

    <!-- Hidden Verse Panel â€” appears after all 10 revealed -->
    <div class="tablets-verse" id="tablets-verse">
      <p style="color: #b496ff; font-size: 1rem; margin-bottom: 8px;">â›°ï¸ ×”×œ×•×—×•×ª ×©×œ××™×!</p>
      <p style="color: rgba(255,255,255,0.8); line-height: 1.8; font-size: 1rem;">
        "×•Ö·×™Ö°×”Ö´×™ ×Ö¹×©Ö¶××” ×‘Ö¸Ö¼×”Ö¸×¨<br>
        <strong style="color: #ffd700; font-size: 1.3rem;">×Ö·×¨Ö°×‘Ö¸Ö¼×¢Ö´×™× ×™×•Ö¹× ×•Ö°×Ö·×¨Ö°×‘Ö¸Ö¼×¢Ö´×™× ×œÖ¸×™Ö°×œÖ¸×”</strong>"
      </p>
      <p style="font-size: 0.8rem; color: rgba(255,215,0,0.5); margin-top: 8px;">×©××•×ª ×›"×“:×™"×— â€” ×›××” ×™××™×?</p>
      <a
        href="https://www.sefaria.org/Exodus.24.18?lang=he"
        target="_blank"
        rel="noopener noreferrer"
        style="display:inline-block; margin-top: 10px; font-size: 0.75rem; color: rgba(180,150,255,0.7); text-decoration: underline;"
      >ğŸ“– ×§×¨× ××ª ×”×¤×¡×•×§ ×‘×¡×¤×¨×™×</a>
    </div>

    <div class="password-section">
      <div class="password-wrapper">
        <input type="text" class="password-input" placeholder="×›××” ×™××™×?..." inputmode="numeric" autocomplete="off">
        <button class="submit-btn">ğŸ”“ ×¤×ª×—</button>
      </div>
      <div class="attempts-display"></div>
      <div class="hint-box">ğŸ’¡ ×’×œ×” ××ª ×›×œ 10 ×”×“×™×‘×¨×•×ª. ×”×¤×¡×•×§ ××’×œ×” ×›××” ×™××™× ××©×” ×©×”×” ×‘×”×¨.</div>
      <div class="hint-box strong">ğŸ”¥ ××¨×‘×¢×™× ×™×•× ×•××¨×‘×¢×™× ×œ×™×œ×”. ×›××” ×–×” ×‘×¡×¤×¨×•×ª?</div>
    </div>

  </div>

  <div class="red-flash"></div>
  <div class="success-overlay">
    <div class="success-message">â›°ï¸ ×”×œ×•×—×•×ª ×‘×™×“×™×š!</div>
    <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px; font-size: 1.1rem;">×¢×›×©×™×• â€” ×‘× ×” ××ª ×‘×™×ª ×”'. ×”××©×›×Ÿ ××—×›×”.</p>
    <a href="room4.html" class="next-room-btn">â†’ ××œ ×”××©×›×Ÿ ğŸº</a>
  </div>

  <!-- Scripts -->
  <script src="particles.js"></script>
  <script src="game.js"></script>
  <script>
    if (!checkRoomAccess(3)) throw 'Access denied';
    new ParticleEngine('particles-canvas', 'dust');
    const timer = new GameTimer();
    const checker = new PasswordChecker('room3', 'room4.html');
    startLightning(6000, 15000);

    let revealedCount = 0;

    function revealCmd(card, index) {
      if (card.classList.contains('revealed')) return;
      card.classList.add('revealed');
      revealedCount++;
      document.getElementById('cmd-count').textContent = revealedCount;

      // Strong hint is shown automatically by CSS/PasswordChecker

      if (revealedCount === 10) {
        setTimeout(() => {
          document.getElementById('tablets-verse').classList.add('visible');
          document.querySelector('.password-input').focus();
        }, 800);
      }
    }

    // â”€â”€ Sinai Canvas â€” Falling commandment words (Matrix style) â”€â”€
    const sinaiCanvas = document.getElementById('sinai-canvas');
    const sinaiCtx = sinaiCanvas.getContext('2d');
    const cmdWords = ['×œ×','×ª×¨×¦×—','×œ×','×ª× ××£','×œ×','×ª×’× ×‘','×›×‘×“','××ª','××‘×™×š','×•××ª','×××š','×–×›×•×¨','××ª','×™×•×','×”×©×‘×ª','×œ×','×ª×©×','×©×','××œ×•×”×™×š','×œ×©×•×','×œ×','×ª×—××•×“','×× ×›×™','×”'];
    const answerWord = '××¨×‘×¢×™×';

    function initSinai() {
      sinaiCanvas.width = sinaiCanvas.parentElement.clientWidth;
      sinaiCanvas.height = 200;

      const columns = Math.floor(sinaiCanvas.width / 25);
      const drops = Array(columns).fill(0).map(() => Math.random() * 20);
      let frame = 0;

      function draw() {
        sinaiCtx.fillStyle = 'rgba(0,0,0,0.08)';
        sinaiCtx.fillRect(0, 0, sinaiCanvas.width, sinaiCanvas.height);
        frame++;

        for (let i = 0; i < drops.length; i++) {
          let word = cmdWords[Math.floor(Math.random() * cmdWords.length)];
          let color = 'rgba(180,150,255,0.6)';
          let size = 14;

          // Every ~200 frames, flash "××¨×‘×¢×™×" in gold
          if (frame % 200 > 170 && frame % 200 < 190) {
            const answerStart = Math.floor(columns / 2) - 2;
            if (i === answerStart) {
              word = answerWord;
              color = '#ffd700';
              size = 20;
              sinaiCtx.shadowBlur = 20;
              sinaiCtx.shadowColor = '#ffd700';
            }
          }

          sinaiCtx.fillStyle = color;
          sinaiCtx.font = size + 'px monospace';
          sinaiCtx.fillText(word.charAt(Math.floor(Math.random() * word.length)), i * 25, drops[i] * 25);
          sinaiCtx.shadowBlur = 0;

          if (drops[i] * 25 > sinaiCanvas.height && Math.random() > 0.975) drops[i] = 0;
          drops[i]++;
        }

        requestAnimationFrame(draw);
      }
      draw();
    }
    initSinai();
    window.addEventListener('resize', initSinai);
  </script>

</body>
</html>
