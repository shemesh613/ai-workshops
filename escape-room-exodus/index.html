<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>×”×¡× ×” ×”×‘×•×¢×¨ â€” ×—×“×¨ ×‘×¨×™×—×” ×™×¦×™××ª ××¦×¨×™×</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* â•â• Cinematic Intro â•â• */
    .entrance-cinematic {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #000; z-index: 1000;
      display: flex; align-items: center; justify-content: center;
      flex-direction: column; transition: opacity 1.5s ease-out;
    }
    .entrance-cinematic.fade-out { opacity: 0; pointer-events: none; }
    .cinematic-text {
      font-family: 'Frank Ruhl Libre', serif;
      font-size: clamp(1.2rem, 4vw, 2rem);
      color: #ffd700; text-align: center; direction: rtl;
      padding: 0 20px; min-height: 3em;
      text-shadow: 0 0 15px rgba(255,150,0,0.6), 0 0 30px rgba(255,100,0,0.3), 0 0 60px rgba(255,50,0,0.15);
      animation: textGlow 2s ease-in-out infinite alternate;
    }
    @keyframes textGlow {
      from { text-shadow: 0 0 15px rgba(255,150,0,0.6), 0 0 30px rgba(255,100,0,0.3); }
      to { text-shadow: 0 0 25px rgba(255,180,0,0.8), 0 0 50px rgba(255,120,0,0.5), 0 0 80px rgba(255,50,0,0.3); }
    }
    .cinematic-sub {
      font-size: 0.9rem; color: rgba(255,150,50,0.5);
      margin-top: 20px; opacity: 0; transition: opacity 1s; text-align: center;
    }
    .cinematic-skip {
      position: absolute; bottom: 30px; right: 30px;
      font-size: 0.75rem; color: rgba(255,255,255,0.2);
      cursor: pointer; border: none; background: none; transition: color 0.3s;
    }
    .cinematic-skip:hover { color: rgba(255,255,255,0.5); }

    /* â•â• Professional CSS Bush â•â• */
    .bush-pro {
      position: relative; width: 220px; height: 220px; margin: 15px auto;
    }
    .bush-body {
      position: absolute; bottom: 25px; left: 50%; transform: translateX(-50%);
      width: 130px; height: 85px;
      background: radial-gradient(ellipse at 50% 60%, #2a7a2a 0%, #1a5a1a 40%, #0d3d0d 100%);
      border-radius: 50%; z-index: 3;
      box-shadow: 0 0 25px rgba(255,100,0,0.25), inset 0 -5px 15px rgba(0,0,0,0.3);
    }
    .bush-body::before, .bush-body::after {
      content: ''; position: absolute; border-radius: 50%;
      background: radial-gradient(ellipse, #2a8a2a 0%, transparent 70%);
    }
    .bush-body::before { width: 65px; height: 45px; top: -18px; left: 5px; }
    .bush-body::after { width: 55px; height: 40px; top: -12px; right: 5px; }
    .bush-trunk {
      position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
      width: 10px; height: 30px;
      background: linear-gradient(to right, #3a2010, #5a3a20, #3a2010);
      border-radius: 0 0 3px 3px; z-index: 2;
    }
    .fire-glow {
      position: absolute; top: -30px; left: 50%; transform: translateX(-50%);
      width: 250px; height: 250px;
      background: radial-gradient(ellipse, rgba(255,100,0,0.15) 0%, rgba(255,50,0,0.05) 40%, transparent 70%);
      animation: glowPulse 2s ease-in-out infinite alternate; z-index: 0; pointer-events: none;
    }
    .fire-wrap {
      position: absolute; bottom: 40px; left: 50%; transform: translateX(-50%);
      width: 100px; height: 140px; z-index: 4; filter: blur(1px);
    }
    .flame {
      position: absolute; bottom: 0; left: 50%;
      border-radius: 50% 50% 30% 30%; mix-blend-mode: screen;
    }
    .flame-1 {
      width: 70px; height: 110px; transform: translateX(-50%);
      background: linear-gradient(to top, rgba(255,80,0,0.9) 0%, rgba(255,160,0,0.7) 30%, rgba(255,220,0,0.4) 60%, transparent 100%);
      animation: flameMain 0.8s ease-in-out infinite alternate;
    }
    .flame-2 {
      width: 50px; height: 90px; left: calc(50% - 15px);
      background: linear-gradient(to top, rgba(255,120,0,0.8) 0%, rgba(255,200,50,0.5) 50%, transparent 100%);
      animation: flameSide 0.6s ease-in-out infinite alternate-reverse;
    }
    .flame-3 {
      width: 45px; height: 85px; left: calc(50% + 10px);
      background: linear-gradient(to top, rgba(255,60,0,0.8) 0%, rgba(255,180,0,0.4) 50%, transparent 100%);
      animation: flameSide2 0.7s ease-in-out infinite alternate;
    }
    .flame-core {
      width: 25px; height: 45px; transform: translateX(-50%);
      background: radial-gradient(ellipse at 50% 80%, rgba(255,255,200,0.9) 0%, rgba(255,200,0,0.5) 40%, transparent 70%);
      animation: coreFlicker 0.4s ease-in-out infinite alternate; z-index: 5;
    }
    .fire-sparks { position: absolute; width: 100%; height: 100%; z-index: 6; pointer-events: none; }
    @keyframes flameMain {
      from { transform: translateX(-50%) scaleY(1) scaleX(1); }
      to { transform: translateX(-50%) scaleY(1.12) scaleX(0.92); }
    }
    @keyframes flameSide {
      from { transform: scaleY(0.95) rotate(-3deg); }
      to { transform: scaleY(1.08) rotate(3deg); }
    }
    @keyframes flameSide2 {
      from { transform: scaleY(1.05) rotate(2deg); }
      to { transform: scaleY(0.92) rotate(-2deg); }
    }
    @keyframes coreFlicker {
      from { opacity: 0.7; transform: translateX(-50%) scaleY(0.95); }
      to { opacity: 1; transform: translateX(-50%) scaleY(1.08); }
    }
    @keyframes glowPulse { from { opacity: 0.5; } to { opacity: 1; } }
    @keyframes sparkUp {
      0% { opacity: 1; transform: translateY(0) translateX(0); }
      100% { opacity: 0; transform: translateY(-70px) translateX(var(--drift, 0px)); }
    }
    .bush-caption {
      text-align: center; font-size: 0.8rem; color: rgba(255,150,50,0.5);
      margin-top: 5px; font-family: 'Frank Ruhl Libre', serif;
    }

    /* â•â• Scratch Card â•â• */
    .scratch-container {
      position: relative; margin: 15px 0; border-radius: 12px;
      overflow: hidden; border: 1px solid rgba(255,150,50,0.3);
      background: rgba(40,10,0,0.3);
    }
    .scratch-hidden-text {
      padding: 25px 20px; text-align: center; direction: rtl;
      font-family: 'Frank Ruhl Libre', serif; line-height: 2;
      font-size: 1rem; color: rgba(255,255,255,0.85);
      min-height: 100px; display: flex; align-items: center; justify-content: center;
    }
    .scratch-hidden-text strong { color: #ffd700; font-size: 1.25rem; }
    .scratch-canvas {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext y='18' font-size='18'%3EğŸª™%3C/text%3E%3C/svg%3E") 12 12, crosshair;
      border-radius: 12px;
    }
    .scratch-progress {
      text-align: center; font-size: 0.75rem; color: rgba(255,100,50,0.4); margin: 3px 0;
    }

    /* â•â• Filter Puzzle â•â• */
    .filter-puzzle {
      margin: 15px 0; padding: 18px; border-radius: 12px;
      border: 1px solid rgba(255,150,50,0.2); background: rgba(30,10,0,0.3);
      display: none;
    }
    .filter-puzzle.unlocked { display: block; animation: scrollReveal 0.8s ease-out; }
    .filter-text {
      font-family: 'Frank Ruhl Libre', serif; font-size: 1.05rem;
      line-height: 2.2; color: rgba(255,255,255,0.85); padding: 20px;
      direction: rtl; transition: filter 0.3s; text-align: center;
      background: rgba(0,0,0,0.3); border-radius: 10px; margin: 10px 0;
    }
    .filter-sliders { display: flex; flex-direction: column; gap: 10px; margin: 12px 0; }
    .slider-row {
      display: flex; align-items: center; gap: 10px; font-size: 0.8rem;
      color: rgba(255,150,100,0.6);
    }
    .slider-row label { min-width: 60px; text-align: left; font-family: 'Secular One', sans-serif; }
    .slider-row input[type="range"] { flex: 1; accent-color: #ff6644; }
    .slider-row .val { min-width: 35px; text-align: center; color: rgba(255,200,150,0.7); }

    /* â•â• Timeline Ordering â•â• */
    .timeline-section {
      margin: 15px 0; display: none;
    }
    .timeline-section.unlocked { display: block; animation: scrollReveal 0.8s ease-out; }
    .timeline-slots {
      display: flex; flex-direction: column; gap: 8px; margin: 10px 0;
    }
    .timeline-slot {
      display: flex; align-items: center; gap: 10px;
      padding: 14px 16px; border-radius: 10px;
      border: 2px dashed rgba(255,150,50,0.25);
      background: rgba(50,20,0,0.15); min-height: 50px;
      transition: all 0.4s; direction: rtl;
    }
    .slot-num {
      display: flex; align-items: center; justify-content: center;
      width: 32px; height: 32px; border-radius: 50%;
      background: rgba(255,150,50,0.12); color: rgba(255,150,50,0.5);
      font-weight: bold; flex-shrink: 0;
      font-family: 'Secular One', sans-serif; font-size: 0.9rem;
    }
    .timeline-slot.filled {
      border-style: solid; border-color: rgba(255,215,0,0.4);
      background: rgba(80,40,0,0.2);
    }
    .timeline-slot.filled .slot-num {
      background: rgba(255,215,0,0.2); color: #ffd700;
    }
    .slot-text {
      font-family: 'Frank Ruhl Libre', serif;
      font-size: 0.85rem; color: rgba(255,255,255,0.8);
      flex: 1; text-align: right; line-height: 1.5;
    }
    .slot-placeholder {
      font-family: 'Frank Ruhl Libre', serif;
      color: rgba(255,150,50,0.25); font-size: 0.8rem;
    }
    .quote-pool {
      display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin: 15px 0;
    }
    .quote-btn {
      padding: 12px 16px; border-radius: 10px; cursor: pointer;
      background: rgba(80,30,0,0.2); border: 2px solid rgba(255,150,50,0.25);
      color: rgba(255,255,255,0.75); font-family: 'Frank Ruhl Libre', serif;
      font-size: 0.8rem; transition: all 0.3s; text-align: center;
      max-width: 300px; line-height: 1.4;
    }
    .quote-btn:hover:not(.used):not(.exploded) {
      background: rgba(120,50,0,0.3); border-color: rgba(255,150,50,0.5);
      transform: translateY(-3px); box-shadow: 0 4px 15px rgba(255,100,0,0.15);
    }
    .quote-btn.used { opacity: 0.3; pointer-events: none; border-color: rgba(0,255,100,0.3); }
    .quote-btn.exploded {
      border-color: rgba(255,50,50,0.5) !important;
      background: rgba(100,0,0,0.2) !important;
      color: #ff6666 !important; opacity: 0.25; pointer-events: none;
    }

    /* â•â• Hard Question â•â• */
    .hard-question {
      margin: 15px 0; padding: 18px; border-radius: 12px;
      border: 1px solid rgba(255,215,0,0.2); background: rgba(50,30,0,0.2);
      display: none; text-align: center;
    }
    .hard-question.unlocked { display: block; animation: scrollReveal 0.8s ease-out; }
    .hq-text { font-size: 1.05rem; color: #fff; margin-bottom: 12px; line-height: 1.7; direction: rtl; }
    .hq-options { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin: 10px 0; }
    .hq-option {
      padding: 14px; border-radius: 10px; cursor: pointer;
      background: rgba(255,215,0,0.05); border: 2px solid rgba(255,215,0,0.15);
      color: rgba(255,255,255,0.7); font-size: 0.95rem; transition: all 0.3s;
      font-family: 'Frank Ruhl Libre', serif;
    }
    .hq-option:hover:not(.picked) { background: rgba(255,215,0,0.12); border-color: rgba(255,215,0,0.35); transform: translateY(-2px); }
    .hq-option.picked { pointer-events: none; }
    .hq-option.correct-pick { border-color: rgba(0,255,100,0.5) !important; background: rgba(0,100,0,0.2) !important; color: #00ff88; }
    .hq-option.wrong-pick { border-color: rgba(255,50,50,0.5) !important; background: rgba(100,0,0,0.2) !important; color: #ff6666; opacity: 0.5; }

    .verse-reveal {
      display: none; margin: 15px 0; padding: 20px;
      background: rgba(80,30,0,0.3); border: 1px solid rgba(255,150,50,0.3);
      border-radius: 12px; text-align: center;
    }
    .verse-reveal.visible { display: block; animation: scrollReveal 0.8s ease-out; }

    .screen-shake { animation: screenShake 0.6s ease-out; }
    @keyframes screenShake {
      0%, 100% { transform: translateX(0); }
      10% { transform: translateX(-8px); } 20% { transform: translateX(8px); }
      30% { transform: translateX(-6px); } 40% { transform: translateX(6px); }
    }
    @keyframes scrollReveal { from { opacity:0; transform:scaleY(0.3); } to { opacity:1; transform:scaleY(1); } }

    @media (max-width: 600px) {
      .quote-btn { font-size: 0.7rem; padding: 10px 12px; max-width: 250px; }
      .hq-options { grid-template-columns: 1fr; }
      .slot-text { font-size: 0.75rem; }
      .filter-text { font-size: 0.9rem; padding: 15px; }
      .bush-pro { width: 180px; height: 180px; }
    }
  </style>
</head>
<body class="theme-burning">

  <!-- â•â• Cinematic Intro â•â• -->
  <div class="entrance-cinematic" id="cinematic">
    <div class="cinematic-text" id="cinematic-text"></div>
    <div class="cinematic-sub" id="cinematic-sub">×©××•×ª ×’:×‘</div>
    <button class="cinematic-skip" onclick="skipCinematic()">×“×œ×’ â†</button>
  </div>

  <!-- Video Background -->
  <video class="video-bg" autoplay muted loop playsinline
    poster="https://images.unsplash.com/photo-1487260211189-670c54da558d?w=1920&q=80">
    <source src="https://cdn.coverr.co/videos/coverr-fire-background-1581/1080p.mp4" type="video/mp4">
  </video>
  <div class="fog-overlay"></div>
  <div class="dark-overlay"></div>
  <canvas id="particles-canvas"></canvas>

  <!-- Timer Bar -->
  <div class="timer-bar">
    <span class="room-indicator">ğŸ”¥ ×©×¢×¨ ×”×›× ×™×¡×” â€” ×”×¡× ×” ×”×‘×•×¢×¨</span>
    <span class="timer-display" id="timer-display">00:00</span>
  </div>

  <!-- Main Content -->
  <div class="room-container">
    <div class="room-header">
      <div class="room-icon">ğŸ”¥</div>
      <h1 class="room-title">×”×¡× ×” ×”×‘×•×¢×¨</h1>
      <p class="room-subtitle">"×•×”×¡× ×” ×‘×•×¢×¨ ×‘××© â€” ×•×”×¡× ×” ××™× × ×• ××•×›×œ"</p>
    </div>

    <div class="question-box">
      <div class="question-text">
        ××©×” × ×”×’ ××ª ×”×¦××Ÿ ××œ ×”×¨ ×”××œ×•×”×™×. ××¦× ××ª ×©× ×”×”×¨ â€” ×•×¤×ª×— ××ª ×”×©×¢×¨.
      </div>
      <div class="question-helper">
        ğŸª™ ×©×œ×‘ 1: ×’×¨×“. ğŸ” ×©×œ×‘ 2: ×¤×¢× ×—. ğŸ“œ ×©×œ×‘ 3: ×¡×“×¨. âš¡ ×©×œ×‘ 4: ×—×™×“×•×Ÿ.
      </div>
    </div>

    <!-- â•â• Professional CSS Burning Bush â•â• -->
    <div class="bush-pro">
      <div class="fire-glow"></div>
      <div class="fire-wrap">
        <div class="flame flame-1"></div>
        <div class="flame flame-2"></div>
        <div class="flame flame-3"></div>
        <div class="flame flame-core"></div>
      </div>
      <div class="bush-body"></div>
      <div class="bush-trunk"></div>
      <div class="fire-sparks" id="fire-sparks"></div>
    </div>
    <div class="bush-caption">ğŸ”¥ ×”×¡× ×” ×‘×•×¢×¨ ×‘××©... ×•×”×¡× ×” ××™× × ×• ××•×›×œ</div>

    <!-- â•â•â• PHASE 1: Scratch Card â•â•â• -->
    <p style="font-size:0.85rem; color:rgba(255,150,50,0.5); text-align:center; margin:10px 0 4px;">
      ğŸª™ ×©×œ×‘ 1 â€” ×’×¨×“ ××ª ×”××’×™×œ×” ×”×¢×ª×™×§×”:
    </p>
    <div class="scratch-container" id="scratch-container">
      <div class="scratch-hidden-text">
        "×•Ö¼×Ö¹×©Ö¶××” ×”Ö¸×™Ö¸×” ×¨Ö¹×¢Ö¶×” ×Ö¶×ª ×¦Ö¹××Ÿ ×™Ö´×ªÖ°×¨×•Ö¹ ×—Ö¹×ªÖ°× ×•Ö¹... ×•Ö·×™Ö¸Ö¼×‘Ö¹× ×Ö¶×œ<br>
        <strong>×”Ö·×¨ ×”Ö¸×Ö±×œÖ¹×”Ö´×™× ×—Ö¹×¨Öµ×‘Ö¸×”</strong>"<br>
        <span style="font-size:0.7rem; color:rgba(255,215,0,0.5);">×©××•×ª ×’:×</span>
      </div>
      <canvas class="scratch-canvas" id="scratch-canvas"></canvas>
    </div>
    <div class="scratch-progress">×’×¨×“×ª: <span id="scratch-percent">0</span>%</div>

    <!-- â•â•â• PHASE 2: CSS Filter Puzzle â•â•â• -->
    <div class="filter-puzzle" id="filter-puzzle">
      <p style="color: #ff8844; font-size: 0.9rem; margin-bottom: 10px;">ğŸ” ×©×œ×‘ 2 â€” ××’×™×œ×” × ×•×¡×¤×ª. ××˜×•×©×˜×©×ª! ×›×•×•×Ÿ ××ª ×”×¡×œ×™×™×“×¨×™× ×›×“×™ ×œ×§×¨×•×:</p>
      <div class="filter-text" id="filter-text">
        "×Ö·×œ ×ªÖ´Ö¼×§Ö°×¨Ö·×‘ ×”Ö²×œÖ¹× â€” ×©Ö·××œ × Ö°×¢Ö¸×œÖ¶×™×šÖ¸ ×Öµ×¢Ö·×œ ×¨Ö·×’Ö°×œÖ¶×™×šÖ¸,
        ×›Ö´Ö¼×™ ×”Ö·×Ö¸Ö¼×§×•Ö¹× ×Ö²×©Ö¶××¨ ×Ö·×ªÖ¸Ö¼×” ×¢×•Ö¹×Öµ×“ ×¢Ö¸×œÖ¸×™×• ×Ö·×“Ö°×Ö·×ª ×§Ö¹×“Ö¶×©× ×”×•Ö¼×"
        <br><span style="font-size:0.7rem; color:rgba(255,215,0,0.5);">×©××•×ª ×’:×”</span>
      </div>
      <div class="filter-sliders">
        <div class="slider-row">
          <label>×˜×©×˜×•×©:</label>
          <input type="range" id="blur-slider" min="0" max="20" value="15">
          <span class="val" id="blur-val">15</span>
        </div>
        <div class="slider-row">
          <label>× ×™×’×•×“×™×•×ª:</label>
          <input type="range" id="contrast-slider" min="20" max="200" value="40">
          <span class="val" id="contrast-val">40</span>
        </div>
        <div class="slider-row">
          <label>×¦×‘×¢:</label>
          <input type="range" id="hue-slider" min="0" max="360" value="180">
          <span class="val" id="hue-val">180</span>
        </div>
      </div>
    </div>

    <!-- â•â•â• PHASE 3: Timeline Ordering â•â•â• -->
    <div class="timeline-section" id="timeline-section">
      <p style="font-size:0.9rem; color:rgba(255,150,50,0.6); text-align:center; margin:8px 0;">
        ğŸ“œ ×©×œ×‘ 3 â€” ×¡×“×¨ ××ª ×ª×©×•×‘×•×ª ××©×” ×œ×¤×™ ×”×¡×“×¨ ×‘×©××•×ª ×’-×“. ×”×™×–×”×¨ ××¤×¡×•×§×™× ××–×•×™×¤×™×!
      </p>

      <div class="timeline-slots" id="timeline-slots">
        <div class="timeline-slot" data-slot="0"><span class="slot-num">1</span><span class="slot-placeholder">×¨××©×•×Ÿ...</span></div>
        <div class="timeline-slot" data-slot="1"><span class="slot-num">2</span><span class="slot-placeholder">×©× ×™...</span></div>
        <div class="timeline-slot" data-slot="2"><span class="slot-num">3</span><span class="slot-placeholder">×©×œ×™×©×™...</span></div>
        <div class="timeline-slot" data-slot="3"><span class="slot-num">4</span><span class="slot-placeholder">×¨×‘×™×¢×™...</span></div>
      </div>

      <div class="quote-pool" id="quote-pool"></div>

      <div style="text-align:center; font-size:0.8rem; color:rgba(255,150,50,0.35); margin:6px 0;">
        × ×‘×—×¨×• <span id="placed-count" style="color:rgba(255,150,50,0.6);">0</span> ××ª×•×š 4
      </div>
    </div>

    <!-- â•â•â• PHASE 4: Hard Question (Avitzur Q16) â•â•â• -->
    <div class="hard-question" id="hard-question">
      <p style="color:#ffd700; font-size:0.85rem; margin-bottom:8px;">âš¡ ×©×œ×‘ 4 â€” ×©××œ×ª ×—×™×“×•×Ÿ ×”×ª× "×š (××§×‘×¥ ××‘×™×¦×•×¨):</p>
      <p class="hq-text">"×•×”××˜×” ××©×¨ × ×”×¤×š ×œ× ×—×© ×ª×™×§×— ×‘×™×“×š" â€” ×œ×¤× ×™ ××™×–×• ××›×” × ×××¨ ×”×¤×¡×•×§?</p>
      <div class="hq-options">
        <div class="hq-option" onclick="answerHQ(this, true)">×“×</div>
        <div class="hq-option" onclick="answerHQ(this, false)">×¦×¤×¨×“×¢</div>
        <div class="hq-option" onclick="answerHQ(this, false)">×›×™× ×™×</div>
        <div class="hq-option" onclick="answerHQ(this, false)">×—×•×©×š</div>
      </div>
    </div>

    <!-- Verse Reveal -->
    <div class="verse-reveal" id="verse-reveal">
      <p style="color: #ff8844; font-size: 1rem; margin-bottom: 10px;">ğŸ”¥ ×›×œ ××¨×‘×¢×ª ×”×©×œ×‘×™× ×”×•×©×œ××•!</p>
      <p style="color: rgba(255,255,255,0.8); line-height: 1.8; font-size: 1.05rem;">
        "×•Ö·×™Ö¸Ö¼×‘Ö¹× ×Ö¶×œ ×”Ö·×¨ ×”Ö¸×Ö±×œÖ¹×”Ö´×™× <strong style="color:#ffd700; font-size:1.3rem;">×—Ö¹×¨Öµ×‘Ö¸×”</strong>"
      </p>
      <p style="font-size: 0.85rem; color: rgba(255,215,0,0.5); margin-top: 10px;">×©× ×”×”×¨ â€” ×”×•× ×”×¡×™×¡××”.</p>
    </div>

    <div class="sefaria-link-box">
      <a href="https://www.sefaria.org/Exodus.3?lang=he" target="_blank" class="sefaria-link">
        ğŸ“œ ×©××•×ª ×’-×“ ×‘×¡×¤×¨×™×
      </a>
    </div>

    <div class="password-section">
      <div class="password-wrapper">
        <input type="text" class="password-input" placeholder="×©× ×”×”×¨..." autocomplete="off">
        <button class="submit-btn">ğŸ”“ ×¤×ª×—</button>
      </div>
      <div class="attempts-display"></div>
      <div class="hint-box">ğŸ’¡ ×’×¨×“ â† ×¤×¢× ×— â† ×¡×“×¨ â† ×¢× ×”. ×©× ×”×”×¨ ××•×¤×™×¢ ×‘××’×™×œ×” ×”×¨××©×•× ×”.</div>
      <div class="hint-box strong">ğŸ”¥ ×”×¨ ×”××œ×•×”×™× = ×—×•×¨×‘ = ×¡×™× ×™. ×”×§×œ×“ ××ª ×”×©× ×”×¨××©×•×Ÿ.</div>
    </div>
  </div>

  <div class="red-flash"></div>
  <div class="success-overlay">
    <div class="success-message">ğŸ”¥ ×”×¡× ×” × ×’×œ×”!</div>
    <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px; font-size: 1.1rem;">×”' ×“×™×‘×¨. ×¢×›×©×™×• â€” ××¦×¨×™×.</p>
    <a href="room1.html" class="next-room-btn">â†’ ×”×™×›× ×¡ ×œ××¦×¨×™× ğŸ¸</a>
  </div>

  <!-- Scripts -->
  <script src="particles.js"></script>
  <script src="game.js"></script>

  <script>
    // â”€â”€â”€ Cinematic Intro â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const cinematicVerse = '×•Ö·×™ÖµÖ¼×¨Ö¸× ×Ö·×œÖ°×Ö·×šÖ° ×”\' ×Öµ×œÖ¸×™×• ×‘Ö°Ö¼×œÖ·×‘Ö·Ö¼×ª ×Öµ×©× ×Ö´×ªÖ¼×•Ö¹×šÖ° ×”Ö·×¡Ö°Ö¼× Ö¶×”';
    const cinematicText = document.getElementById('cinematic-text');
    let charIdx = 0;

    function typeChar() {
      if (charIdx < cinematicVerse.length) {
        cinematicText.textContent = cinematicVerse.substring(0, charIdx + 1);
        charIdx++;
        setTimeout(typeChar, 65 + Math.random() * 35);
      } else {
        document.getElementById('cinematic-sub').style.opacity = '1';
        setTimeout(() => skipCinematic(), 2500);
      }
    }
    setTimeout(typeChar, 800);

    function skipCinematic() {
      const el = document.getElementById('cinematic');
      if (!el || el.classList.contains('fade-out')) return;
      el.classList.add('fade-out');
      setTimeout(() => el.remove(), 1500);
    }

    // â”€â”€â”€ CSS Bush Sparks â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const sparksEl = document.getElementById('fire-sparks');
    function createSpark() {
      const s = document.createElement('div');
      const drift = (Math.random() * 30 - 15) + 'px';
      s.style.cssText = `position:absolute; width:3px; height:3px; background:#ffd700;
        border-radius:50%; bottom:${30+Math.random()*35}%; left:${35+Math.random()*30}%;
        box-shadow: 0 0 4px rgba(255,215,0,0.8); pointer-events:none;
        animation: sparkUp ${1+Math.random()*1.5}s ease-out forwards;
        --drift: ${drift};`;
      sparksEl.appendChild(s);
      setTimeout(() => s.remove(), 2500);
    }
    setInterval(createSpark, 250);

    // â”€â”€â”€ Phase tracking â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let phase1Done = false, phase2Done = false, phase3Done = false, phase4Done = false;

    // â•â•â• PHASE 1: Scratch Card â•â•â•
    const scratchCanvas = document.getElementById('scratch-canvas');
    const scratchCtx = scratchCanvas.getContext('2d');
    let isScratching = false;

    function initScratch() {
      const container = document.getElementById('scratch-container');
      scratchCanvas.width = container.offsetWidth;
      scratchCanvas.height = container.offsetHeight;

      const grad = scratchCtx.createLinearGradient(0, 0, scratchCanvas.width, scratchCanvas.height);
      grad.addColorStop(0, '#5a3a1a'); grad.addColorStop(0.3, '#6b4a2a');
      grad.addColorStop(0.6, '#4a2a0a'); grad.addColorStop(1, '#3a1a00');
      scratchCtx.fillStyle = grad;
      scratchCtx.fillRect(0, 0, scratchCanvas.width, scratchCanvas.height);

      for (let i = 0; i < 3000; i++) {
        scratchCtx.fillStyle = `rgba(${Math.random()>0.5?255:0},${Math.random()>0.5?200:0},${Math.random()>0.5?100:0},${Math.random()*0.08})`;
        scratchCtx.fillRect(Math.random()*scratchCanvas.width, Math.random()*scratchCanvas.height, 2, 2);
      }

      scratchCtx.fillStyle = 'rgba(255,215,100,0.4)';
      scratchCtx.font = '18px "Frank Ruhl Libre", serif';
      scratchCtx.textAlign = 'center';
      scratchCtx.fillText('ğŸª™ ×’×¨×“ ×›××Ÿ ×œ×—×©×•×£ ××ª ×”××’×™×œ×”', scratchCanvas.width/2, scratchCanvas.height/2-10);
      scratchCtx.font = '14px "Frank Ruhl Libre", serif';
      scratchCtx.fillStyle = 'rgba(255,200,100,0.25)';
      scratchCtx.fillText('××’×™×œ×ª ×”×¡× ×” ×”×‘×•×¢×¨', scratchCanvas.width/2, scratchCanvas.height/2+20);
    }

    function scratch(x, y) {
      scratchCtx.globalCompositeOperation = 'destination-out';
      scratchCtx.beginPath();
      scratchCtx.arc(x, y, 22, 0, Math.PI * 2);
      scratchCtx.fill();
      scratchCtx.globalCompositeOperation = 'source-over';
    }

    function checkScratchProgress() {
      const imageData = scratchCtx.getImageData(0, 0, scratchCanvas.width, scratchCanvas.height);
      let transparent = 0;
      const total = scratchCanvas.width * scratchCanvas.height;
      for (let i = 3; i < imageData.data.length; i += 4) {
        if (imageData.data[i] < 128) transparent++;
      }
      const percent = Math.floor((transparent / total) * 100);
      document.getElementById('scratch-percent').textContent = percent;

      if (percent >= 40 && !phase1Done) {
        phase1Done = true;
        scratchCanvas.style.transition = 'opacity 0.5s';
        scratchCanvas.style.opacity = '0';
        setTimeout(() => {
          scratchCanvas.style.display = 'none';
          document.getElementById('filter-puzzle').classList.add('unlocked');
        }, 500);
      }
    }

    scratchCanvas.addEventListener('mousedown', () => { isScratching = true; });
    scratchCanvas.addEventListener('mouseup', () => { isScratching = false; checkScratchProgress(); });
    scratchCanvas.addEventListener('mouseleave', () => { isScratching = false; });
    scratchCanvas.addEventListener('mousemove', (e) => {
      if (!isScratching) return;
      const rect = scratchCanvas.getBoundingClientRect();
      scratch(e.clientX - rect.left, e.clientY - rect.top);
    });
    scratchCanvas.addEventListener('touchstart', (e) => { e.preventDefault(); isScratching = true; });
    scratchCanvas.addEventListener('touchend', () => { isScratching = false; checkScratchProgress(); });
    scratchCanvas.addEventListener('touchmove', (e) => {
      e.preventDefault();
      const touch = e.touches[0];
      const rect = scratchCanvas.getBoundingClientRect();
      scratch(touch.clientX - rect.left, touch.clientY - rect.top);
    });

    initScratch();

    // â•â•â• PHASE 2: CSS Filter Puzzle â•â•â•
    const filterText = document.getElementById('filter-text');
    const blurSlider = document.getElementById('blur-slider');
    const contrastSlider = document.getElementById('contrast-slider');
    const hueSlider = document.getElementById('hue-slider');

    filterText.style.filter = 'blur(15px) contrast(0.4) hue-rotate(180deg)';

    function updateFilters() {
      const b = blurSlider.value, c = contrastSlider.value, h = hueSlider.value;
      document.getElementById('blur-val').textContent = b;
      document.getElementById('contrast-val').textContent = c;
      document.getElementById('hue-val').textContent = h;
      filterText.style.filter = `blur(${b}px) contrast(${c/100}) hue-rotate(${h}deg)`;

      if (parseInt(b) <= 2 && parseInt(c) >= 80 && (parseInt(h) <= 30 || parseInt(h) >= 330) && !phase2Done) {
        phase2Done = true;
        filterText.style.filter = 'none';
        filterText.style.textShadow = '0 0 10px rgba(255,215,0,0.3)';
        setTimeout(() => document.getElementById('timeline-section').classList.add('unlocked'), 500);
      }
    }

    [blurSlider, contrastSlider, hueSlider].forEach(s => s.addEventListener('input', updateFilters));

    // â•â•â• PHASE 3: Timeline Ordering â•â•â•
    const quotes = [
      { text: '"××™ ×× ×›×™ ×›×™ ××œ×š ××œ ×¤×¨×¢×”"', ref: '×©××•×ª ×’:×™×', order: 0, real: true },
      { text: '"×•×××¨×• ×œ×™ ××” ×©××• ××” ××•××¨ ××œ×”×"', ref: '×©××•×ª ×’:×™×’', order: 1, real: true },
      { text: '"×•×”×Ÿ ×œ× ×™×××™× ×• ×œ×™ ×•×œ× ×™×©××¢×• ×‘×§×œ×™"', ref: '×©××•×ª ×“:×', order: 2, real: true },
      { text: '"×©×œ×— × × ×‘×™×“ ×ª×©×œ×—"', ref: '×©××•×ª ×“:×™×’', order: 3, real: true },
      { text: '"×œ××” ×”×¨×¢×ª×” ×œ×¢× ×”×–×”"', ref: '', order: -1, real: false },
      { text: '"×”× × ×™ ×¢××“ ×œ×¤× ×™×š ×©× ×¢×œ ×”×¦×•×¨ ×‘×—×¨×‘"', ref: '', order: -1, real: false },
    ];

    const shuffled = [...quotes];
    for (let i = shuffled.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }

    let currentSlot = 0;
    const pool = document.getElementById('quote-pool');

    shuffled.forEach((q, idx) => {
      const btn = document.createElement('div');
      btn.className = 'quote-btn';
      btn.textContent = q.text;
      btn.dataset.idx = idx;
      btn.onclick = () => pickQuote(btn, q);
      pool.appendChild(btn);
    });

    function pickQuote(btn, quote) {
      if (phase3Done || btn.classList.contains('used') || btn.classList.contains('exploded')) return;

      if (!quote.real) {
        btn.classList.add('exploded');
        document.body.classList.add('screen-shake');
        const flash = document.querySelector('.red-flash');
        flash.classList.remove('active'); void flash.offsetWidth; flash.classList.add('active');
        setTimeout(() => document.body.classList.remove('screen-shake'), 600);
        const errors = parseInt(localStorage.getItem(GAME.STORAGE_PREFIX + 'Errors') || '0') + 1;
        localStorage.setItem(GAME.STORAGE_PREFIX + 'Errors', errors.toString());
        return;
      }

      if (quote.order === currentSlot) {
        btn.classList.add('used');
        const slot = document.querySelectorAll('.timeline-slot')[currentSlot];
        slot.classList.add('filled');
        const placeholder = slot.querySelector('.slot-placeholder');
        if (placeholder) placeholder.remove();
        const textEl = document.createElement('span');
        textEl.className = 'slot-text';
        textEl.innerHTML = quote.text + '<span style="font-size:0.65rem; color:rgba(255,215,0,0.4); margin-right:8px;">' + quote.ref + '</span>';
        slot.appendChild(textEl);

        currentSlot++;
        document.getElementById('placed-count').textContent = currentSlot;

        if (currentSlot === 4) {
          phase3Done = true;
          setTimeout(() => document.getElementById('hard-question').classList.add('unlocked'), 600);
        }
      } else {
        btn.style.borderColor = 'rgba(255,100,50,0.6)';
        document.body.classList.add('screen-shake');
        const flash = document.querySelector('.red-flash');
        flash.classList.remove('active'); void flash.offsetWidth; flash.classList.add('active');
        setTimeout(() => {
          document.body.classList.remove('screen-shake');
          btn.style.borderColor = '';
        }, 600);
        const errors = parseInt(localStorage.getItem(GAME.STORAGE_PREFIX + 'Errors') || '0') + 1;
        localStorage.setItem(GAME.STORAGE_PREFIX + 'Errors', errors.toString());
      }
    }

    // â•â•â• PHASE 4: Hard Question (Avitzur Q16) â•â•â•
    function answerHQ(el, isCorrect) {
      if (phase4Done) return;
      document.querySelectorAll('.hq-option').forEach(o => o.classList.add('picked'));
      el.classList.add(isCorrect ? 'correct-pick' : 'wrong-pick');

      if (isCorrect) {
        phase4Done = true;
        setTimeout(() => {
          document.getElementById('verse-reveal').classList.add('visible');
          document.querySelector('.password-input').focus();
        }, 600);
      } else {
        document.body.classList.add('screen-shake');
        const flash = document.querySelector('.red-flash');
        flash.classList.remove('active'); void flash.offsetWidth; flash.classList.add('active');
        setTimeout(() => document.body.classList.remove('screen-shake'), 600);
        const errors = parseInt(localStorage.getItem(GAME.STORAGE_PREFIX + 'Errors') || '0') + 1;
        localStorage.setItem(GAME.STORAGE_PREFIX + 'Errors', errors.toString());
        setTimeout(() => {
          document.querySelectorAll('.hq-option').forEach(o => o.classList.remove('picked', 'wrong-pick'));
        }, 1200);
      }
    }

    // â”€â”€â”€ Initialize Game Engine â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    new ParticleEngine('particles-canvas', 'burning');
    const timer = new GameTimer();
    const checker = new PasswordChecker('index', 'room1.html');
  </script>

</body>
</html>
